<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate a Dynamic Factor Model — DFM • dfms</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Estimate a Dynamic Factor Model — DFM"><meta name="description" content="Efficient estimation of a Dynamic Factor Model via the EM Algorithm - on stationary data
with time-invariant system matrices and classical assumptions, while permitting missing data."><meta property="og:description" content="Efficient estimation of a Dynamic Factor Model via the EM Algorithm - on stationary data
with time-invariant system matrices and classical assumptions, while permitting missing data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dfms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://sebkrantz.github.io/Rblog/">Blog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SebKrantz/dfms" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate a Dynamic Factor Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/SebKrantz/dfms/blob/v0.4.0/R/DFM.R" class="external-link"><code>R/DFM.R</code></a></small>
      <div class="d-none name"><code>DFM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Efficient estimation of a Dynamic Factor Model via the EM Algorithm - on stationary data
with time-invariant system matrices and classical assumptions, while permitting missing data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DFM</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  idio.ar1 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quarterly.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rQ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"diagonal"</span>, <span class="st">"identity"</span><span class="op">)</span>,</span>
<span>  rR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diagonal"</span>, <span class="st">"identity"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  em.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"DGR"</span>, <span class="st">"BM"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  min.iter <span class="op">=</span> <span class="fl">25L</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  pos.corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check.increased <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <code>T x n</code> numeric data matrix or frame of stationary time series. May contain missing values. <em>Note</em> that data is internally standardized (scaled and centered) before estimation.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>integer. Number of factors.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>integer. Number of lags in factor VAR.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(optional) arguments to <code><a href="tsnarmimp.html">tsnarmimp</a></code>. The default settings impute internal missing values with a cubic spline and the edges with the median and a 3-period moving average.</p></dd>


<dt id="arg-idio-ar-">idio.ar1<a class="anchor" aria-label="anchor" href="#arg-idio-ar-"></a></dt>
<dd><p>logical. Model observation errors as AR(1) processes: \(e_t = \rho e_{t-1} + v_t\). <em>Note</em> that this substantially increases computation time, and is generally not needed if <code>n</code> is large (&gt;30). See theoretical vignette for details.</p></dd>


<dt id="arg-quarterly-vars">quarterly.vars<a class="anchor" aria-label="anchor" href="#arg-quarterly-vars"></a></dt>
<dd><p>character. Names of quarterly variables in <code>X</code> (if any). Monthly variables should be to the left of the quarterly variables in the data matrix and quarterly observations should be provided every 3rd period.</p></dd>


<dt id="arg-rq">rQ<a class="anchor" aria-label="anchor" href="#arg-rq"></a></dt>
<dd><p>character. Restrictions on the state (transition) covariance matrix (Q).</p></dd>


<dt id="arg-rr">rR<a class="anchor" aria-label="anchor" href="#arg-rr"></a></dt>
<dd><p>character. Restrictions on the observation (measurement) covariance matrix (R).</p></dd>


<dt id="arg-em-method">em.method<a class="anchor" aria-label="anchor" href="#arg-em-method"></a></dt>
<dd><p>character. The implementation of the Expectation Maximization Algorithm used. The options are:</p><table class="table table"><tr><td><code>"auto"</code></td><td></td><td>Automatic selection: <code>"BM"</code> if <code>anyNA(X)</code>, else <code>"DGR"</code>.</td><td></td></tr><tr><td><code>"DGR"</code></td><td></td><td>The classical EM implementation of Doz, Giannone and Reichlin (2012). This implementation is efficient and quite robust, missing values are removed on a casewise basis in the Kalman Filter and Smoother, but not explicitly accounted for in EM iterations.</td><td></td></tr><tr><td><code>"BM"</code></td><td></td><td>The modified EM algorithm of Banbura and Modugno (2014) which also accounts for missing data in the EM iterations. Optimal for datasets with systematically missing data e.g. datasets with ragged edges or series at different frequencies.</td><td></td></tr><tr><td><code>"none"</code></td><td></td><td>Performs no EM iterations and just returns the Two-Step estimates from running the data through the Kalman Filter and Smoother once as in
Doz, Giannone and Reichlin (2011) (the Kalman Filter is Initialized with system matrices obtained from a regression and VAR on PCA factor estimates).
This yields significant performance gains over the iterative methods. Final system matrices are estimated by running a regression and a VAR on the smoothed factors.</td><td></td></tr></table></dd>


<dt id="arg-min-iter">min.iter<a class="anchor" aria-label="anchor" href="#arg-min-iter"></a></dt>
<dd><p>integer. Minimum number of EM iterations (to ensure a convergence path).</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>integer. Maximum number of EM iterations.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric. EM convergence tolerance.</p></dd>


<dt id="arg-pos-corr">pos.corr<a class="anchor" aria-label="anchor" href="#arg-pos-corr"></a></dt>
<dd><p>logical. Increase the likelihood that factors correlate positively with the data, by scaling the eigenvectors such that the principal components (used to initialize the Kalman Filter) co-vary positively with the row-means of the standardized data.</p></dd>


<dt id="arg-check-increased">check.increased<a class="anchor" aria-label="anchor" href="#arg-check-increased"></a></dt>
<dd><p>logical. Check if likelihood has increased. Passed to <code><a href="em_converged.html">em_converged</a></code>. If <code>TRUE</code>, the algorithm only terminates if convergence was reached with decreasing likelihood.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list-like object of class 'dfm' with the following elements:</p>
<dl><dt><code>X_imp</code></dt>
<dd><p>\(T \times n\) matrix with the imputed and standardized (scaled and centered) data—after applying <code><a href="tsnarmimp.html">tsnarmimp</a></code>. It has attributes attached allowing for reconstruction of the original data:</p><table class="table table"><tr><td><code>"stats"</code></td><td></td><td>is a \(n \times 5\) matrix of summary statistics of class <code>"qsu"</code> (see <code><a href="https://fastverse.org/collapse/reference/qsu.html" class="external-link">qsu</a></code>).</td><td></td></tr><tr><td><code>"missing"</code></td><td></td><td>is a \(T \times n\) logical matrix indicating missing or infinite values in the original data (which are imputed in <code>X_imp</code>).</td><td></td></tr><tr><td><code>"attributes"</code></td><td></td><td>contains the <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></code> of the original data input.</td><td></td></tr><tr><td><code>"is.list"</code></td><td></td><td>is a logical value indicating whether the original data input was a list / data frame.</td><td></td></tr></table></dd>

<dt><code>eigen</code></dt>
<dd><p><code>eigen(cov(X_imp))</code>.</p></dd>

<dt><code>F_pca</code></dt>
<dd><p>\(T \times r\) matrix of principal component factor estimates - <code>X_imp %*% eigen$vectors</code>.</p></dd>

<dt><code>P_0</code></dt>
<dd><p>\(r \times r\) initial factor covariance matrix estimate based on PCA results.</p></dd>

<dt><code>F_2s</code></dt>
<dd><p>\(T \times r\) matrix two-step factor estimates as in Doz, Giannone and Reichlin (2011) - obtained from running the data through the Kalman Filter and Smoother once, where the Filter is initialized with results from PCA.</p></dd>

<dt><code>P_2s</code></dt>
<dd><p>\(r \times r \times T\) covariance matrices of two-step factor estimates.</p></dd>

<dt><code>F_qml</code></dt>
<dd><p>\(T \times r\) matrix of quasi-maximum likelihood factor estimates - obtained by iteratively Kalman Filtering and Smoothing the factor estimates until EM convergence.</p></dd>

<dt><code>P_qml</code></dt>
<dd><p>\(r \times r \times T\) covariance matrices of QML factor estimates.</p></dd>

<dt><code>A</code></dt>
<dd><p>\(r \times rp\) factor transition matrix.</p></dd>

<dt><code>C</code></dt>
<dd><p>\(n \times r\) observation matrix.</p></dd>

<dt><code>Q</code></dt>
<dd><p>\(r \times r\) state (error) covariance matrix.</p></dd>

<dt><code>R</code></dt>
<dd><p>\(n \times n\) observation (error) covariance matrix.</p></dd>

<dt><code>e</code></dt>
<dd><p>\(T \times n\) estimates of observation errors \(\textbf{e}_t\). Only available if <code>idio.ar1 = TRUE</code>.</p></dd>

<dt><code>rho</code></dt>
<dd><p>\(n \times 1\) estimates of AR(1) coefficients (\(\rho\)) in observation errors: \(e_t = \rho e_{t-1} + v_t\). Only available if <code>idio.ar1 = TRUE</code>.</p></dd>

<dt><code>loglik</code></dt>
<dd><p>vector of log-likelihoods - one for each EM iteration. The final value corresponds to the log-likelihood of the reported model.</p></dd>

<dt><code>tol</code></dt>
<dd><p>The numeric convergence tolerance used.</p></dd>

<dt><code>converged</code></dt>
<dd><p>single logical valued indicating whether the EM algorithm converged (within <code>max.iter</code> iterations subject to <code>tol</code>).</p></dd>

<dt><code>anyNA</code></dt>
<dd><p>single logical valued indicating whether there were any (internal) missing values in the data (determined after removal of rows with too many missing values). If <code>FALSE</code>, <code>X_imp</code> is simply the original data in matrix form, and does not have the <code>"missing"</code> attribute attached.</p></dd>

<dt><code>rm.rows</code></dt>
<dd><p>vector of any cases (rows) that were removed beforehand (subject to <code>max.missing</code> and <code>na.rm.method</code>). If no cases were removed the slot is <code>NULL</code>.</p></dd>

<dt><code>quarterly.vars</code></dt>
<dd><p>names of the quarterly variables (if any).</p></dd>

<dt><code>em.method</code></dt>
<dd><p>The EM method used.</p></dd>

<dt><code>call</code></dt>
<dd><p>call object obtained from <code><a href="https://rdrr.io/r/base/match.call.html" class="external-link">match.call()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function efficiently estimates a Dynamic Factor Model with the following classical assumptions:</p><ol><li><p>Linearity</p></li>
<li><p>Idiosynchratic measurement (observation) errors (<em>R</em> is diagonal)</p></li>
<li><p>No direct relationship between series and lagged factors (<em>ceteris paribus</em> contemporaneous factors)</p></li>
<li><p>No relationship between lagged error terms in the either measurement or transition equation (no serial correlation), unless explicitly modeled as AR(1) processes using <code>idio.ar1 = TRUE</code>.</p></li>
</ol><p>Factors are allowed to evolve in a \(VAR(p)\) process, and data is internally standardized (scaled and centered) before estimation (removing the need of intercept terms).
By assumptions 1-4, this translates into the following dynamic form:</p>
<p>$$\textbf{x}_t = \textbf{C}_0 \textbf{f}_t + \textbf{e}_t \ \sim\  N(\textbf{0}, \textbf{R})$$
$$\textbf{f}_t = \sum_{j=1}^p \textbf{A}_j \textbf{f}_{t-j} + \textbf{u}_t \ \sim\  N(\textbf{0}, \textbf{Q}_0)$$</p>
<p>where the first equation is called the measurement or observation equation and the second equation is called transition, state or process equation, and</p>
<table class="table table"><tr><td>\(n\)</td><td></td><td>number of series in \(\textbf{x}_t\) (\(r\) and \(p\) as the arguments to <code>DFM</code>).</td><td></td></tr><tr><td>\(\textbf{x}_t\)</td><td></td><td>\(n \times 1\) vector of observed series at time \(t\): \((x_{1t}, \dots, x_{nt})'\). Some observations can be missing.</td><td></td></tr><tr><td>\(\textbf{f}_t\)</td><td></td><td>\(r \times 1\) vector of factors at time \(t\): \((f_{1t}, \dots, f_{rt})'\).</td><td></td></tr><tr><td>\(\textbf{C}_0\)</td><td></td><td>\(n \times r\) measurement (observation) matrix.</td><td></td></tr><tr><td>\(\textbf{A}_j\)</td><td></td><td>\(r \times r\) state transition matrix at lag \(j\).</td><td></td></tr><tr><td>\(\textbf{Q}_0\)</td><td></td><td>\(r \times r\) state covariance matrix.</td><td></td></tr><tr><td>\(\textbf{R}\)</td><td></td><td>\(n \times n\) measurement (observation) covariance matrix. It is diagonal by assumption 2 that \(E[\textbf{x}_{it}|\textbf{x}_{-i,t},\textbf{x}_{i,t-1}, \dots, \textbf{f}_t, \textbf{f}_{t-1}, \dots] = \textbf{Cf}_t \forall i\).</td><td></td></tr></table><p>This model can be estimated using a classical form of the Kalman Filter and the Expectation Maximization (EM) algorithm, after transforming it to State-Space (stacked, VAR(1)) form:</p>
<p>$$\textbf{x}_t = \textbf{C} \textbf{F}_t + \textbf{e}_t \ \sim\  N(\textbf{0}, \textbf{R})$$
$$\textbf{F}_t = \textbf{A F}_{t-1} + \textbf{u}_t \ \sim\  N(\textbf{0}, \textbf{Q})$$</p>
<p>where</p><table class="table table"><tr><td>\(n\)</td><td></td><td>number of series in \(\textbf{x}_t\) (\(r\) and \(p\) as the arguments to <code>DFM</code>).</td><td></td></tr><tr><td>\(\textbf{x}_t\)</td><td></td><td>\(n \times 1\) vector of observed series at time \(t\): \((x_{1t}, \dots, x_{nt})'\). Some observations can be missing.</td><td></td></tr><tr><td>\(\textbf{F}_t\)</td><td></td><td>\(rp \times 1\) vector of stacked factors at time \(t\): \((f_{1t}, \dots, f_{rt}, f_{1,t-1}, \dots, f_{r,t-1}, \dots, f_{1,t-p}, \dots, f_{r,t-p})'\).</td><td></td></tr><tr><td>\(\textbf{C}\)</td><td></td><td>\(n \times rp\) observation matrix. Only the first \(n \times r\) terms are non-zero, by assumption 3 that \(E[\textbf{x}_t|\textbf{F}_t] = E[\textbf{x}_t|\textbf{f}_t]\) (no relationship of observed series with lagged factors given contemporaneous factors).</td><td></td></tr><tr><td>\(\textbf{A}\)</td><td></td><td>stacked \(rp \times rp\) state transition matrix consisting of 3 parts: the top \(r \times rp\) part provides the dynamic relationships captured by \((\textbf{A}_1, \dots, \textbf{A}_p)\) in the dynamic form, the terms <code>A[(r+1):rp, 1:(rp-r)]</code> constitute an \((rp-r) \times (rp-r)\) identity matrix mapping all lagged factors to their known values at times t. The remaining part <code>A[(rp-r+1):rp, (rp-r+1):rp]</code> is an \(r \times r\) matrix of zeros.</td><td></td></tr><tr><td>\(\textbf{Q}\)</td><td></td><td>\(rp \times rp\) state covariance matrix. The top \(r \times r\) part gives the contemporaneous relationships, the rest are zeros by assumption 4.</td><td></td></tr><tr><td>\(\textbf{R}\)</td><td></td><td>\(n \times n\) observation covariance matrix. It is diagonal by assumption 2 and identical to \(\textbf{R}\) as stated in the dynamic form.</td><td></td></tr></table><p>The filter is initialized with PCA estimates on the imputed dataset—see <code><a href="SKFS.html">SKFS</a></code> for a complete code example.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Doz, C., Giannone, D., &amp; Reichlin, L. (2011). A two-step estimator for large approximate dynamic factor models based on Kalman filtering. <em>Journal of Econometrics, 164</em>(1), 188-205.</p>
<p>Doz, C., Giannone, D., &amp; Reichlin, L. (2012). A quasi-maximum likelihood approach for large, approximate dynamic factor models. <em>Review of Economics and Statistics, 94</em>(4), 1014-1024.</p>
<p>Banbura, M., &amp; Modugno, M. (2014). Maximum likelihood estimation of factor models on datasets with arbitrary pattern of missing data. <em>Journal of Applied Econometrics, 29</em>(1), 133-160.</p>
<p>Stock, J. H., &amp; Watson, M. W. (2016). Dynamic Factor Models, Factor-Augmented Vector Autoregressions, and Structural Vector Autoregressions in Macroeconomics. <em>Handbook of Macroeconomics, 2</em>, 415–525. https://doi.org/10.1016/bs.hesmac.2016.04.002</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="dfms-package.html">dfms-package</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joshuaulrich.github.io/xts/" class="external-link">xts</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.pfaffikus.de" class="external-link">vars</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MASS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: strucchange</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sandwich</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: urca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: lmtest</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># BM14 Replication Data. Constructing the database:</span></span></span>
<span class="r-in"><span><span class="va">BM14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">BM14_M</span>, <span class="va">BM14_Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">log_trans</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"M"</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">### Small Model ---------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># IC for number of factors</span></span></span>
<span class="r-in"><span><span class="va">IC_small</span> <span class="op">&lt;-</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">small</span><span class="op">]</span>, max.r <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># I take 2 factors. Now number of lags</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      6      5      2      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1          2         3          4         5          6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) -1.5028163 -1.7020957 -1.701093 -1.7021266 -1.782692 -1.7977899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  -1.4762557 -1.6578279 -1.639118 -1.6224446 -1.685303 -1.6826936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  -1.4361151 -1.5909270 -1.545457 -1.5020229 -1.538121 -1.5087511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n)  0.2225028  0.1823018  0.182486  0.1822997  0.168192  0.1656763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 7          8          9         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) -1.7892503 -1.7887748 -1.7793434 -1.7708400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  -1.6564469 -1.6382643 -1.6111258 -1.5849153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  -1.4557440 -1.4108011 -1.3569022 -1.3039313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n)  0.1671036  0.1671913  0.1687862  0.1702408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimating the model with 2 factors and 3 lags</span></span></span>
<span class="r-in"><span><span class="va">dfm_small</span> <span class="op">&lt;-</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">small</span><span class="op">]</span>, r <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    quarterly.vars <span class="op">=</span> <span class="va">BM14_Models</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span> <span class="va">series</span><span class="op">[</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span> <span class="op">&amp;</span> <span class="va">small</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 26 iterations.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspecting the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed Frequency Dynamic Factor Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n = 14, nm = 10, nq = 4, T = 356, r = 2, p = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> %NA = 38.3628, %NAm = 26.3202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14[, BM14_Models$small], r = 2, p = 3, quarterly.vars = BM14_Models %$%      series[freq == "Q" &amp; small])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean  Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.1605  0.1274  2.0755  -9.4638  3.1838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356   0.1049  0.0463  1.3905  -4.2535  5.3709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     L1.f1   L1.f2   L2.f1   L2.f2   L3.f1    L3.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1 1.2824 -0.1946 -0.2100  0.2179 -0.1402 -0.05373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 0.1709  0.5829  0.2514 -0.2866 -0.6082  0.41312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1   4.3077   -0.5272*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  -0.5272*   1.9334 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        u1     u2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1 0.3026 0.2191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2 0.2191 0.4764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Matrix [C]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             f1      f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr             0.2516  0.1905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                0.0265  0.0290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                  0.1725  0.1659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl       0.0533  0.0067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind         0.2650  0.4645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                 0.1296  0.4786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                    -0.3799  0.1838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val  0.0601  0.0865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                 0.1307  0.2383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                 0.0958  0.1625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                     0.0434  0.0217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                    0.0437 -0.0249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                0.0392  0.0116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                  0.0268  0.0437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Error Covariance Matrix [diag(R) - Restricted]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.6269                 0.9909                 0.7924 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.9845                 0.3332                 0.3706 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.1681                 0.9688                 0.8183 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.9096                 0.3599                 0.1326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.4659                 0.6048 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Residual Covariance Matrix [cov(resid(DFM))]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        ip_tot_cstr  new_cars    orders ret_turnover_defl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                0.6016   -0.0155    0.1950*          -0.0191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                  -0.0155    0.9946   -0.0080            0.1262 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                     0.1950*  -0.0080    0.7821            0.0324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl         -0.0191    0.1262    0.0324            0.9864 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind           -0.0209   -0.0282   -0.0861*          -0.0101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                   -0.0687   -0.0472   -0.0187            0.0022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                        0.0113   -0.0158    0.0547*          -0.0098 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val     0.0697    0.0963    0.0742           -0.0190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                   -0.0373    0.0556   -0.0904            0.0107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                    0.0921    0.1067    0.0067            0.0323 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                        0.0720   -0.0844    0.0107           -0.0055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                      -0.0031   -0.1102   -0.0405           -0.0695 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                  -0.0066   -0.0474   -0.0520           -0.1209 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                    -0.0740   -0.0115    0.0609           -0.1050 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        ecs_ec_sent_ind   pms_pmi       urx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                   -0.0209   -0.0687    0.0113 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                      -0.0282   -0.0472   -0.0158 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                        -0.0861*  -0.0187    0.0547*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl             -0.0101    0.0022   -0.0098 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind                0.2434   -0.0836*  -0.0114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                       -0.0836*   0.2982    0.0106 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                           -0.0114    0.0106    0.1409 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val        -0.0697*  -0.0419    0.0077 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                       -0.0358   -0.0396   -0.0014 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                       -0.0433    0.0339    0.0248 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                           -0.0258    0.0604    0.0200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                           0.0444    0.1233    0.0351 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                      -0.0473    0.0574    0.0304 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                        -0.0519    0.0210    0.0555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        extra_ea_trade_exp_val   euro325   raw_mat       gdp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                           0.0697   -0.0373    0.0921    0.0720 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                              0.0963    0.0556    0.1067   -0.0844 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                                0.0742   -0.0904    0.0067    0.0107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl                    -0.0190    0.0107    0.0323   -0.0055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind                      -0.0697*  -0.0358   -0.0433   -0.0258 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                              -0.0419   -0.0396    0.0339    0.0604 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                                   0.0077   -0.0014    0.0248    0.0200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val                0.9673    0.0112   -0.0329    0.0482 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                               0.0112    0.7982    0.0097    0.0341 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                              -0.0329    0.0097    0.8984    0.0022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                                   0.0482    0.0341    0.0022    0.8794 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                                 -0.0869    0.0905    0.0372    0.4779*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                             -0.0428    0.0477   -0.1930*   0.5392*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                               -0.0780    0.1076    0.0037    0.3432*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             empl  capacity    gdp_us</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr             -0.0031   -0.0066   -0.0740 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                -0.1102   -0.0474   -0.0115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                  -0.0405   -0.0520    0.0609 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl       -0.0695   -0.1209   -0.1050 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind          0.0444   -0.0473   -0.0519 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                  0.1233    0.0574    0.0210 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                      0.0351    0.0304    0.0555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val  -0.0869   -0.0428   -0.0780 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                  0.0905    0.0477    0.1076 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                  0.0372   -0.1930*   0.0037 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                      0.4779*   0.5392*   0.3432*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                     0.8218    0.4565*   0.1683*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                 0.4565*   0.9166    0.2969*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                   0.1683*   0.2969*   0.9371 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual AR(1) Serial Correlation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.38749               -0.40829               -0.41500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.49326               -0.09350                0.08832 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.09171               -0.52651                0.24433 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0.27610                     NA                     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     NA                     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10  -0.1807  -0.2405  0.3062  -0.5265  0.2761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness of Fit: R-Squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.3984                 0.0054                 0.2179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.0136                 0.7566                 0.7018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.8591                 0.0327                 0.2018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.1016                 0.1206                 0.1782 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.0834                 0.0629 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14  0.2667  0.1494  0.2939  0.0054  0.8591</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span>  <span class="co"># Factors and data</span></span></span>
<span class="r-plt img"><img src="DFM-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span>, method <span class="op">=</span> <span class="st">"all"</span>, type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span> <span class="co"># Factor estimates</span></span></span>
<span class="r-plt img"><img src="DFM-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span></span>
<span class="r-plt img"><img src="DFM-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 10 periods ahead forecast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Medium-Sized Model ---------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># IC for number of factors</span></span></span>
<span class="r-in"><span><span class="va">IC_medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">medium</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># I take 3 factors. Now number of lags</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7      2      1      7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               1        2        3        4        5        6        7        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) 1.539267 1.492781 1.498671 1.509014 1.486111 1.479450 1.468524 1.490378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  1.592388 1.585744 1.631474 1.681659 1.698597 1.731776 1.760691 1.822386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  1.672669 1.726236 1.832177 1.942573 2.019721 2.113112 2.202238 2.324143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 4.661186 4.449528 4.475952 4.522752 4.420750 4.391987 4.345059 4.442132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               9       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) 1.500199 1.534401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  1.872048 1.946092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  2.434016 2.568271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 4.487352 4.645257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimating the model with 3 factors and 3 lags</span></span></span>
<span class="r-in"><span><span class="va">dfm_medium</span> <span class="op">&lt;-</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">medium</span><span class="op">]</span>, r <span class="op">=</span> <span class="fl">3</span>, p <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    quarterly.vars <span class="op">=</span> <span class="va">BM14_Models</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span> <span class="va">series</span><span class="op">[</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span> <span class="op">&amp;</span> <span class="va">medium</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 26 iterations.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspecting the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed Frequency Dynamic Factor Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n = 48, nm = 39, nq = 9, T = 356, r = 3, p = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> %NA = 32.6135, %NAm = 24.0781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14[, BM14_Models$medium], r = 3, p = 3, quarterly.vars = BM14_Models %$%      series[freq == "Q" &amp; medium])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD       Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.0985   0.4918  3.1283  -19.3582  5.3549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356   0.0341   -0.224  2.2831    -6.462  8.3411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  356  -0.0172  -0.1399  1.5726   -6.7371  4.3577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L1.f1    L1.f2  L1.f3   L2.f1    L2.f2    L2.f3   L3.f1  L3.f2    L3.f3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.93895 -0.19728 0.1715 0.05318  0.06486  0.01496 -0.1298 0.0859 -0.02337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.30923  0.75786 0.1641 0.38513 -0.38768 -0.02307 -0.2750 0.4086  0.02054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.06881  0.03244 0.4077 0.36873 -0.32608 -0.17889 -0.4565 0.3461  0.11805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2        f3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1   9.7864   -0.6567    0.3212 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  -0.6567    5.2124    0.0848 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3   0.3212    0.0848    2.4729 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         u1      u2      u3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1  1.8586  1.3143 -0.3865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2  1.3143  1.8104 -0.5786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u3 -0.3865 -0.5786  1.8320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   39  -0.0901  -0.0699  0.2595  -0.5508  0.3205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   48  0.2894   0.155  0.2852  0.0086  0.9362</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span>  <span class="co"># Factors and data</span></span></span>
<span class="r-plt img"><img src="DFM-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span>, method <span class="op">=</span> <span class="st">"all"</span>, type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span> <span class="co"># Factor estimates</span></span></span>
<span class="r-plt img"><img src="DFM-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span></span>
<span class="r-plt img"><img src="DFM-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 10 periods ahead forecast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Large Model ---------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># IC for number of factors</span></span></span>
<span class="r-in"><span><span class="va">IC_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># I take 6 factors. Now number of lags</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      6      1      1      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1          2          3          4          5          6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)   6.020768   5.926947   5.883307   5.889824   5.897327   5.845883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)    6.206692   6.272235   6.387960   6.553841   6.720708   6.828628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)    6.487677   6.794063   7.150631   7.557355   7.965066   8.313830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 411.908362 375.087393 359.232802 361.888929 365.116976 347.515300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 7          8          9         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)   5.908082   5.963699   5.982969   6.111831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)    7.050191   7.265172   7.443806   7.732032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)    8.776235   9.232061   9.651538  10.180607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 370.862536 393.546431 403.139879 461.355079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimating the model with 6 factors and 3 lags</span></span></span>
<span class="r-in"><span><span class="va">dfm_large</span> <span class="op">&lt;-</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span>, r <span class="op">=</span> <span class="fl">6</span>, p <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    quarterly.vars <span class="op">=</span> <span class="va">BM14_Models</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span> <span class="va">series</span><span class="op">[</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 39 iterations.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspecting the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed Frequency Dynamic Factor Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n = 101, nm = 92, nq = 9, T = 356, r = 6, p = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> %NA = 29.7363, %NAm = 25.8366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14, r = 6, p = 3, quarterly.vars = BM14_Models %$%      series[freq == "Q"])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD       Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356   -0.107   0.6573  4.8387  -23.1251  14.7986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356  -0.2216   0.1847  3.4756  -13.9892  17.5939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  356  -0.0085    0.038   2.538    -9.952    7.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  356   0.1225   0.2815  3.1901  -17.2132  11.1281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  356  -0.0816  -0.0857  2.6977  -11.8225  11.6105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  356  -0.0021  -0.0044  2.2638   -8.0332  14.3884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      L1.f1    L1.f2     L1.f3     L1.f4    L1.f5     L1.f6      L2.f1    L2.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.4146 -0.31547  0.535594 -0.409677  0.24935 -0.042001 -0.0013023  0.10535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.1181  0.42170 -0.132113 -0.044417  0.11608  0.126305  0.0865712 -0.02060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.2563  0.07508  0.387405  0.069762 -0.13764 -0.102988 -0.1223568  0.01331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.2962 -0.12730  0.098611 -0.104417  0.48309 -0.037316  0.0466138 -0.10279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.3225  0.08940 -0.008011  0.344206  0.09136  0.009044 -0.0134199  0.07329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6 -0.1849  0.10457 -0.088462 -0.009701 -0.07510  0.362577  0.0007091 -0.06256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L2.f3    L2.f4     L2.f5    L2.f6    L3.f1    L3.f2    L3.f3    L3.f4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1 -0.18944 -0.17725 -0.036033  0.48920  0.32166 -0.06934  0.06825  0.05621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  0.04108 -0.06438  0.172166 -0.08944  0.15363  0.22166  0.11864 -0.13273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.27139  0.19914 -0.010737  0.02744 -0.04957 -0.08776  0.10569  0.12061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  0.04184 -0.17465 -0.003223  0.16731  0.07214 -0.11843 -0.03447  0.12219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5 -0.08275 -0.01601 -0.107952 -0.10232 -0.17649  0.02642 -0.00477  0.01682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  0.03254 -0.04805  0.086758 -0.10416  0.09119  0.06214  0.13715 -0.12928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L3.f5    L3.f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.15754  0.05201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  0.01799  0.09386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.11424  0.01713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.06460  0.07272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.03395 -0.14320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  0.05089  0.02547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2        f3        f4        f5        f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  23.4128    0.7031   -0.2198    3.7881*  -2.5178*  -1.9928*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2   0.7031   12.0798   -1.6485*  -0.4811   -0.6676    2.4008*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  -0.2198   -1.6485*   6.4415   -1.4691*   1.4553*  -0.9491*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4   3.7881*  -0.4811   -1.4691*  10.1768   -4.6435*  -0.4141 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  -2.5178*  -0.6676    1.4553*  -4.6435*   7.2774   -0.4585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  -1.9928*   2.4008*  -0.9491*  -0.4141   -0.4585    5.1250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         u1      u2      u3      u4      u5      u6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1 10.2115  0.2060 -1.4420  2.4061 -2.2408  0.2968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2  0.2060  5.8639 -0.0814  0.8044 -0.6562  0.1438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u3 -1.4420 -0.0814  4.3219 -0.5280  0.4627  0.1162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u4  2.4061  0.8044 -0.5280  4.9253 -1.6502  0.0570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u5 -2.2408 -0.6562  0.4627 -1.6502  4.4696 -0.0469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u6  0.2968  0.1438  0.1162  0.0570 -0.0469  3.1868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   92  -0.0673  -0.0953  0.2657  -0.4957  0.6614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   101  0.4297  0.3892  0.3071  0.0121  0.9987</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span>  <span class="co"># Factors and data</span></span></span>
<span class="r-plt img"><img src="DFM-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># plot(dfm_large, method = "all", type = "individual") # Factor estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_large</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span></span>
<span class="r-plt img"><img src="DFM-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 10 periods ahead forecast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DFM-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Mixed-Frequency Model with AR(1) Idiosyncratic Errors ---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate model with AR(1) observation errors</span></span></span>
<span class="r-in"><span><span class="co"># This models e(t) = rho * e(t-1) + v(t) for each series</span></span></span>
<span class="r-in"><span><span class="va">dfm_large_ar1</span> <span class="op">&lt;-</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span>, r <span class="op">=</span> <span class="fl">6</span>, p <span class="op">=</span> <span class="fl">3</span>, idio.ar1 <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    quarterly.vars <span class="op">=</span> <span class="va">BM14_Models</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span> <span class="va">series</span><span class="op">[</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 27 iterations.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model summary shows AR(1) coefficients</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_large_ar1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixed Frequency Dynamic Factor Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n = 101, nm = 92, nq = 9, T = 356, r = 6, p = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> %NA = 29.7363, %NAm = 25.8366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    with AR(1) errors: mean(abs(rho)) = 0.272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14, r = 6, p = 3, idio.ar1 = TRUE, quarterly.vars = BM14_Models %$%      series[freq == "Q"])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD       Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.0932   0.4356  4.1258  -26.3399   7.2689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356   0.0141   0.3348  2.8144  -13.6388  14.9466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  356  -0.0904   0.0623  2.4063  -10.6054   7.7731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  356   0.0655   0.1567  2.4883   -9.7491     9.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  356  -0.0532  -0.0793  2.2006   -7.0683   7.9831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  356   0.0785   0.1214  1.7718    -9.055   4.8855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L1.f1    L1.f2     L1.f3    L1.f4     L1.f5    L1.f6    L2.f1     L2.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.36294 -0.33739  0.390802 -0.16640  0.015708  0.17678  0.16782 -0.034706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.04303  0.20884 -0.072546  0.15323  0.009384 -0.03609  0.08371  0.035102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.16766  0.12552  0.333441  0.03715 -0.056107 -0.13851 -0.07633 -0.049216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.14238 -0.02027  0.104313 -0.03705  0.409972  0.05844  0.02029 -0.025738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.18039  0.01489 -0.035480  0.28023  0.120216 -0.06277 -0.01386  0.017727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6 -0.06093  0.04987  0.009273  0.05994 -0.011549  0.19555 -0.04598  0.006984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        L2.f3     L2.f4     L2.f5    L2.f6    L3.f1    L3.f2    L3.f3     L3.f4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1 -0.061362 -0.084291  0.066044  0.13487  0.29337 -0.02864  0.07579 -0.025627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.079912 -0.011331  0.004003  0.06906  0.22750  0.28135  0.10763 -0.008841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.150995  0.187179  0.072732 -0.17937 -0.06504 -0.08119  0.10897  0.058212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  0.009792 -0.147390  0.052710  0.04956 -0.08077 -0.11240 -0.10943  0.115191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5 -0.051458 -0.089720 -0.112780  0.06085 -0.05774  0.04967  0.06603  0.012034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6 -0.068374  0.007569 -0.049427  0.04002  0.06585  0.06722  0.05816 -0.026570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L3.f5    L3.f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.02247 -0.05281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.01189  0.13155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.11803 -0.04513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.13004  0.06949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.07094 -0.15219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  0.04678  0.07416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2        f3        f4        f5        f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  17.0224    0.9532   -0.1667   -0.0775   -0.3385   -0.2222 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2   0.9532    7.9206   -0.2488   -1.0206*   0.1217   -0.3593 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  -0.1667   -0.2488    5.7905    0.0333   -0.0485   -0.0480 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  -0.0775   -1.0206*   0.0333    6.1916   -1.3488*   0.3836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  -0.3385    0.1217   -0.0485   -1.3488*   4.8426    0.1443 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  -0.2222   -0.3593   -0.0480    0.3836    0.1443    3.1392 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         u1      u2      u3      u4      u5      u6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1  6.6526 -0.5783 -1.1405  1.3603 -1.3792  0.6104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2 -0.5783  5.3191  0.0332 -0.1322 -0.2439 -0.5950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u3 -1.1405  0.0332  4.4231  0.0626 -0.0724  0.1648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u4  1.3603 -0.1322  0.0626  4.7055 -0.9944  0.4509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u5 -1.3792 -0.2439 -0.0724 -0.9944  4.1330  0.1573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u6  0.6104 -0.5950  0.1648  0.4509  0.1573  2.9458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   101  -0.0581  -0.1326  0.3254  -0.6311  0.9075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   101  0.6087  0.6793  0.2909  0.0039  0.9975</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access AR(1) coefficients (rho) for each series</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dfm_large_ar1</span><span class="op">$</span><span class="va">rho</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ip_total    ip_tot_cstr ip_tot_cstr_en      ip_constr    ip_im_goods </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.4565217     -0.4189399     -0.6310923     -0.3832824     -0.1150151 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ip_capital </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.3351250 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access estimated observation errors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dfm_large_ar1</span><span class="op">$</span><span class="va">e</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ip_total   ip_tot_cstr ip_tot_cstr_en     ip_constr    ip_im_goods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.090700e-41  2.773400e-43  -9.284405e-25  1.068275e-49  1.229385e-109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -3.169609e-41 -1.163997e-43   7.234494e-25 -1.071486e-49 -1.413799e-110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  4.299249e-41  4.926788e-44  -6.744676e-25  2.137958e-49  1.610407e-111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -8.210496e-41 -2.184188e-44   7.709324e-25 -5.325980e-49 -4.893789e-113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  1.743392e-40  1.201861e-44  -1.033646e-24  1.379910e-48 -1.179288e-111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -3.793705e-40 -1.188133e-44   1.519262e-24 -3.596541e-48  1.043790e-110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ip_capital     ip_d_cstr    ip_nd_cons         ip_en       ip_en_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.944303e-56  1.888720e-84  4.816108e-66 -9.555744e-56 -1.944248e-66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  8.178211e-57 -5.369288e-85 -3.094479e-66  1.295765e-55  2.187136e-66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -7.701158e-57  9.752601e-85  7.051130e-66 -3.266343e-55 -6.486240e-66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  1.738260e-56 -4.665112e-84 -2.394640e-65  9.346773e-55  2.281459e-65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -4.999318e-56  2.390846e-83  8.478264e-65 -2.718771e-54 -8.145441e-65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  1.485491e-55 -1.228627e-82 -3.011926e-64  7.923738e-54  2.911579e-64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ip_manuf     ip_metals  ip_chemicals   ip_electric  ip_machinery</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  3.811841e-28  1.061574e-61  2.808696e-57 -1.379006e-49 -9.142109e-37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -2.798538e-28 -4.290610e-62 -2.626191e-57  1.129823e-49  5.296934e-37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  2.611274e-28  4.675522e-62  5.939577e-57 -1.982737e-49 -4.251618e-37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -3.194775e-28 -1.237244e-61 -1.715952e-56  4.769731e-49  5.453626e-37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  4.721270e-28  3.941849e-61  5.122161e-56 -1.220941e-48 -9.538318e-37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -7.641334e-28 -1.281107e-60 -1.534681e-55  3.155888e-48  1.866478e-36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ip_paper    ip_plastic      new_cars        orders ret_turnover_defl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -6.441647e-94 -6.682650e-44 -5.749264e-45 -1.469969e-66       -3.86140700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.642492e-93  5.150991e-44  4.387543e-45  9.461044e-67        2.01426869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.558201e-92 -7.472124e-44 -6.504336e-45 -1.156951e-66       -0.97525169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  9.303855e-92  1.538219e-43  1.377787e-44  2.266244e-66        0.04166604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -5.557195e-91 -3.479769e-43 -3.197471e-44 -5.135422e-66       -0.51489075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  3.319347e-90  8.024085e-43  7.552159e-44  1.199259e-65        1.81347305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_ec_sent_ind  ecs_ind_conf ecs_ind_order_book ecs_ind_stocks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    7.019681e-40  2.458348e-58      -2.324592e-53  -2.327511e-29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   -2.529104e-39 -3.460365e-58       3.951806e-53   2.307864e-29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1.099037e-38  2.899652e-57      -2.799512e-52  -5.547478e-29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   -4.828063e-38 -2.601194e-56       2.108370e-51   1.662147e-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    2.122165e-37  2.335500e-55      -1.589624e-50  -5.116898e-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   -9.328206e-37 -2.096969e-54       1.198534e-49   1.579794e-27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_ind_prod_exp ecs_ind_prod_rec_m ecs_ind_x_orders ecs_ind_empl_exp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    -1.963344e-42      -7.053766e-17     2.581352e-56    -5.788957e-51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     1.781038e-42       5.036705e-17    -1.823120e-56     3.407008e-50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    -7.377403e-42      -5.294718e-17     1.386374e-55    -2.242466e-49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     3.691013e-41       7.944348e-17    -1.232320e-54     1.480006e-48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    -1.861997e-40      -1.418243e-16     1.097726e-53    -9.768506e-48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]     9.396237e-40       2.682671e-16    -9.778589e-53     6.447533e-47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_cons_conf ecs_cons_sit_over_next_12 ecs_cons_exp_unempl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -6.746136e-74             -8.441318e-59       7.186846e-111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  1.093414e-72              7.454530e-58      -8.399174e-112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.792053e-71             -6.769903e-57       5.646915e-110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  2.937213e-70              6.150267e-56      -4.278867e-108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -4.814155e-69             -5.587369e-55       3.242321e-106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  7.890504e-68              5.075990e-54      -2.456875e-104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_cons_gen_last_12m ecs_cstr_conf ecs_cstr_order_books ecs_cstr_empl_exp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         -1.558279e-59 -3.864650e-39        -3.206632e-32     -3.142529e-34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]         -1.801058e-59  4.273319e-39         2.448859e-32      2.393847e-34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]         -1.614725e-58 -1.614561e-38        -5.921301e-32     -6.334039e-34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]         -1.569366e-57  7.133020e-38         1.962234e-31      2.268084e-33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]         -1.526639e-56 -3.178655e-37        -6.721948e-31     -8.345304e-33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]         -1.485088e-55  1.417108e-36         2.309332e-30      3.076863e-32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_cstr_prod_recent ecs_ret_tr_conf ecs_ret_tr_bus_sit ecs_ret_tr_stocks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]        -2.074378e-53    3.631713e-39       1.110684e-40     -1.086935e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]         8.861033e-53   -1.719347e-39      -6.909123e-41      9.565073e-24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]        -6.762395e-52    4.616078e-39       2.365973e-40     -1.649752e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]         5.230494e-51   -2.042420e-38      -1.121462e-39      3.763642e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]        -4.046531e-50    9.335982e-38       5.406575e-39     -9.118502e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]         3.130580e-49   -4.274274e-37      -2.608431e-38      2.232554e-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ecs_ret_tr_exp_bus ecs_ret_tr_empl  ecs_serv_conf ecs_serv_empl_exp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       1.768988e-43   -8.626704e-38 -1.746649e-150    -7.221803e-182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      -2.671458e-43    1.183339e-37  2.045560e-150     8.941669e-183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       1.254029e-42   -3.936167e-37 -1.202534e-149    -1.207501e-183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      -6.449884e-42    1.477913e-36  7.891663e-149     9.738593e-184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       3.329385e-41   -5.599817e-36 -5.192910e-148    -6.789456e-183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]      -1.718839e-40    2.123122e-35  3.417277e-147     5.477853e-182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pms_comp_output  pms_comp_empl       pms_pmi pms_manuf_empl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]               0 -3.446477e-217 2.425447e-271 -1.875658e-234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]               0  2.708394e-218 4.646938e-270  9.584543e-236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]               0 -2.128376e-219 8.899469e-269 -4.897667e-237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]               0  1.672572e-220 1.704358e-267  2.502690e-238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]               0 -1.314381e-221 3.264056e-266 -1.278866e-239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]               0  1.032898e-222 6.251069e-265  6.534958e-241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pms_manuf_output pms_manuf_product   pms_serv_out  pms_serv_empl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -1.385982e-159    -8.746639e-158 -5.438809e-313 -1.475161e-142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1.957084e-160    -1.311423e-158  1.862736e-314  3.138414e-143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   -2.763512e-161    -1.966276e-159 -6.379680e-316 -6.677037e-144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    3.902232e-162    -2.948127e-160  2.185075e-317  1.420752e-144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   -5.510168e-163    -4.420261e-161 -7.775506e-319 -3.032455e-145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    7.780664e-164    -6.627498e-162  8.787303e-319  6.912067e-146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      pms_serv_new_bus pms_serv_product          urx    empl_total  empl_tot_xc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                0   -5.532815e-122 1.527306e-50 -2.189655e-08 1.664538e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                0   -1.507222e-122 6.916613e-51 -2.105954e-08 1.666183e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                0   -5.383310e-123 3.140323e-51 -2.054119e-08 1.689056e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]                0   -6.611946e-123 1.443543e-51 -2.033363e-08 1.733449e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]                0   -2.124985e-122 7.026725e-52 -2.043374e-08 1.799928e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]                0   -7.898323e-122 4.271091e-52 -2.084302e-08 1.889340e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          empl_cstr   empl_manuf extra_ea_trade_exp_val intra_ea_trade_exp_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -3.909774e-20 1.130804e-05             -0.1173080              0.5300049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -3.037622e-20 1.125250e-05             -0.6082641              0.5613434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -2.429536e-20 1.130307e-05              0.2089724              0.6935698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -2.032653e-20 1.146023e-05             -0.3888678             -0.8632375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -1.812472e-20 1.172545e-05             -0.7122444              0.9965301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] -1.749851e-20 1.210123e-05              0.1964240             -0.8188774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      extra_ea_trade_imp_val intra_ea_trade_imp_val      us_ip     us_urx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]              0.7441252              0.3905597  0.4464705 -0.5972064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]              2.2986685             -2.2884988 -0.6994935 -0.3270729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]             -2.5212749              1.2639157 -1.5727228  1.6812686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]              1.4758380             -0.1257012 -1.9704646  1.5982896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]              0.1805347              0.1019460 -0.7847065 -0.6068660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]              0.1648355              0.3371970 -0.5442462  0.4663372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          us_empl us_retail_sales us_ip_manuf_exp us_cons_exp   us_r3_m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.68805923   -3.879492e-85      1.09995435 -0.16821408  1.841994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.05923627    8.964934e-85      0.21804294 -0.96714338  3.912328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.32778663   -3.271557e-84     -2.65396143  0.31640642 -2.906317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.87144459    1.245807e-83     -2.95870846 -0.02023559 -7.023246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.01071255   -4.758257e-83      0.16277231  0.99325909 -1.871839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.64722814    1.817750e-82      0.06523476 -0.58291072  2.277664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      us_r10_year          m3        loans      ir_long       ir_short</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   4.8907708  0.07194975 6.259551e-78 3.374236e-65 -1.710178e-112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.1963391  0.94025272 1.492565e-78 8.668876e-66 -3.188068e-113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -3.0176803 -0.63796022 3.566169e-79 4.511839e-66 -5.943110e-114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  -2.1176326 -0.08400808 8.822942e-80 1.124106e-65 -1.107899e-114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -0.2053264  0.37246930 3.448220e-80 4.509294e-65 -2.065324e-115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   1.8400670  1.31812770 6.462160e-80 1.877460e-64 -3.850596e-116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ir_1_year     ir_2_year     ir_5_year          eer       eer_cpi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.220272e-98 8.549943e-151 3.681757e-156 0.0004557372  6.827481e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.745420e-99 1.796414e-151 7.405038e-157 0.0002974932 -4.009777e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 6.176765e-100 3.808120e-152 1.618525e-157 0.0002342173  4.175719e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.389675e-100 9.676741e-153 9.959707e-158 0.0002457102 -3.143740e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 3.126552e-101 1.002608e-152 3.551094e-157 0.0003356407  5.343853e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 7.034274e-102 4.016726e-152 1.743610e-156 0.0005327172 -9.123236e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           eer_ppi     exr_usd    exr_gbp    rxr_yen        euro50       euro325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.978315e-69  0.73454196 -1.0565458  2.4954660 -2.529723e-60 -6.362085e-59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 6.337630e-69  0.37396618 -0.2080339 -0.4297539 -3.060252e-61 -8.108712e-60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 2.205470e-68 -0.20597328 -1.6671123  0.4294326 -3.702041e-62 -1.033485e-60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 8.077629e-68  0.53680789 -1.5342581 -3.8573492 -4.478426e-63 -1.317215e-61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 2.970038e-67  0.07440597 -0.7810578 -2.2184222 -5.417632e-64 -1.678839e-62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 1.092360e-66  0.24086153 -0.4188286  1.8411043 -6.553806e-65 -2.139743e-63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            sp500       dow_j  raw_mat_en raw_mat_oil raw_mat_gold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.431919190 -0.17589384  0.81784534 -0.34892116  -0.06331777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.010685447  0.10735651 -0.25481550 -0.01625208  -3.53588829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.109158959 -0.11497711 -0.22658581  0.06371555  -2.19498973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.007235308  0.03244591  0.08718499  0.16768271  -1.29570277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.166750379 -0.18766044 -0.69483895  0.06920533   3.06659121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.015507310  0.02006015  0.31392001 -0.07390485   1.48255729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      raw_mat_oil_fwd     raw_mat         gdp   priv_cons     invest      export</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1.322800e-28 -0.40362743  0.04292267 -0.07682953 0.04696923 -0.13995419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    4.144101e-29 -0.12983426  0.05129271 -0.05790409 0.06563161 -0.08840784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1.299791e-29  0.37714437  0.09987802 -0.15427628 0.11585092 -0.22419183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    4.125192e-30  0.16670567  0.04691497 -0.01023578 0.08187876 -0.10553460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    1.463590e-30 -0.06393378  0.01649269  0.05402172 0.06276925 -0.06993188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    1.005651e-30 -0.08081010 -0.02636112  0.20745746 0.04525212  0.03071138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           import       empl    prductivity      capacity       gdp_us</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.01986328 0.25685434 -2.190174e-184 -2.715323e-43 -0.087264721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.01055342 0.18337707  1.464337e-185  1.253871e-42 -0.104537037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.04353313 0.13800700 -9.790471e-187 -5.812130e-42 -0.194121324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.04643295 0.09459807  6.545849e-188  2.694602e-41 -0.112607167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.09398922 0.05497276 -4.376515e-189 -1.249274e-40 -0.065167393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.21910457 0.02206330  2.926111e-190  5.791894e-40 -0.001692607</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with model without AR(1) errors</span></span></span>
<span class="r-in"><span><span class="va">dfm_large_ar1</span><span class="op">$</span><span class="va">loglik</span>  <span class="co"># Log-likelihood path</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -37569.02 -37273.48 -37113.12 -36999.05 -36919.58 -36867.57 -36833.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] -36810.86 -36793.18 -36778.36 -36765.15 -36752.93 -36741.45 -36730.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] -36720.29 -36710.54 -36701.32 -36692.67 -36684.63 -36677.25 -36670.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] -36664.51 -36659.09 -36654.22 -36649.84 -36645.88 -36642.28</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Krantz, Rytis Bagdziunas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

