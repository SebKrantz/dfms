<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate a Dynamic Factor Model — DFM • dfms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate a Dynamic Factor Model — DFM"><meta property="og:description" content="Efficient estimation of a Dynamic Factor Model via the EM Algorithm - on stationary data
with time-invariant system matrices and classical assumptions, while permitting missing data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dfms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SebKrantz/dfms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate a Dynamic Factor Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/SebKrantz/dfms/blob/HEAD/R/DFM.R" class="external-link"><code>R/DFM.R</code></a></small>
    <div class="hidden name"><code>DFM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Efficient estimation of a Dynamic Factor Model via the EM Algorithm - on stationary data
with time-invariant system matrices and classical assumptions, while permitting missing data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">DFM</span><span class="op">(</span>
  <span class="va">X</span>,
  <span class="va">r</span>,
  p <span class="op">=</span> <span class="fl">1L</span>,
  <span class="va">...</span>,
  idio.ar1 <span class="op">=</span> <span class="cn">FALSE</span>,
  rQ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"diagonal"</span>, <span class="st">"identity"</span><span class="op">)</span>,
  rR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diagonal"</span>, <span class="st">"identity"</span>, <span class="st">"none"</span><span class="op">)</span>,
  em.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"DGR"</span>, <span class="st">"BM"</span>, <span class="st">"none"</span><span class="op">)</span>,
  min.iter <span class="op">=</span> <span class="fl">25L</span>,
  max.iter <span class="op">=</span> <span class="fl">100L</span>,
  tol <span class="op">=</span> <span class="fl">1e-04</span>,
  pos.corr <span class="op">=</span> <span class="cn">TRUE</span>,
  check.increased <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>a <code>T x n</code> numeric data matrix or frame of stationary time series. May contain missing values.</p></dd>


<dt>r</dt>
<dd><p>integer. number of factors.</p></dd>


<dt>p</dt>
<dd><p>integer. number of lags in factor VAR.</p></dd>


<dt>...</dt>
<dd><p>(optional) arguments to <code><a href="tsnarmimp.html">tsnarmimp</a></code>.</p></dd>


<dt>idio.ar1</dt>
<dd><p>logical. Model observation errors as AR(1) processes: \(e_t = \rho e_{t-1} + v_t\). <em>Note</em> that this substantially increases computation time, and is generaly not needed if <code>n</code> is large (&gt;30). See theoretical vignette for details.</p></dd>


<dt>rQ</dt>
<dd><p>character. restrictions on the state (transition) covariance matrix (Q).</p></dd>


<dt>rR</dt>
<dd><p>character. restrictions on the observation (measurement) covariance matrix (R).</p></dd>


<dt>em.method</dt>
<dd><p>character. The implementation of the Expectation Maximization Algorithm used. The options are:</p><table class="table table"><tr><td><code>"auto"</code></td><td></td><td>Automatic selection: <code>"BM"</code> if <code>anyNA(X)</code>, else <code>"DGR"</code>.</td><td></td></tr><tr><td><code>"DGR"</code></td><td></td><td>The classical EM implementation of Doz, Giannone and Reichlin (2012). This implementation is efficient and quite robust, missing values are removed on a casewise basis in the Kalman Filter and Smoother, but not explicitly accounted for in EM iterations.</td><td></td></tr><tr><td><code>"BM"</code></td><td></td><td>The modified EM algorithm of Banbura and Modugno (2014) which also accounts for missing data in the EM iterations. Optimal for datasets with systematically missing data e.g. datasets with ragged edges or series at different frequencies.</td><td></td></tr><tr><td><code>"none"</code></td><td></td><td>Performs no EM iterations and just returns the Two-Step estimates from running the data through the Kalman Filter and Smoother once as in
Doz, Giannone and Reichlin (2011) (the Kalman Filter is Initialized with system matrices obtained from a regression and VAR on PCA factor estimates).
This yields significant performance gains over the iterative methods. Final system matrices are estimated by running a regression and a VAR on the smoothed factors.</td><td></td></tr></table></dd>


<dt>min.iter</dt>
<dd><p>integer. Minimum number of EM iterations (to ensure a convergence path).</p></dd>


<dt>max.iter</dt>
<dd><p>integer. Maximum number of EM iterations.</p></dd>


<dt>tol</dt>
<dd><p>numeric. EM convergence tolerance.</p></dd>


<dt>pos.corr</dt>
<dd><p>logical. Increase the likelihood that factors correlate positively with the data, by scaling the eigenvectors such that the principal components (used to initialize the Kalman Filter) co-vary positively with the row-means of the standardized data.</p></dd>


<dt>check.increased</dt>
<dd><p>logical. Check if likelihood has increased. Passed to <code><a href="em_converged.html">em_converged</a></code>. If <code>TRUE</code>, the algorithm only terminates if convergence was reached with decreasing likelihood.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list-like object of class 'dfm' with the following elements:</p>
<dl><dt><code>X_imp</code></dt>
<dd><p>\(T \times n\) matrix with the imputed and standardized (scaled and centered) data - with attributes attached allowing reconstruction of the original data:</p><table class="table table"><tr><td><code>"stats"</code></td><td></td><td>is a \(n \times 5\) matrix of summary statistics of class <code>"qsu"</code> (see <code><a href="https://sebkrantz.github.io/collapse/reference/qsu.html" class="external-link">qsu</a></code>).</td><td></td></tr><tr><td><code>"missing"</code></td><td></td><td>is a \(T \times n\) logical matrix indicating missing or infinite values in the original data (which are imputed in <code>X_imp</code>).</td><td></td></tr><tr><td><code>"attributes"</code></td><td></td><td>contains the <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></code> of the original data input.</td><td></td></tr><tr><td><code>"is.list"</code></td><td></td><td>is a logical value indicating whether the original data input was a list / data frame.</td><td></td></tr></table></dd>

<dt><code>eigen</code></dt>
<dd><p><code>eigen(cov(X_imp))</code>.</p></dd>

<dt><code>F_pca</code></dt>
<dd><p>\(T \times r\) matrix of principal component factor estimates - <code>X_imp %*% eigen$vectors</code>.</p></dd>

<dt><code>P_0</code></dt>
<dd><p>\(r \times r\) initial factor covariance matrix estimate based on PCA results.</p></dd>

<dt><code>F_2s</code></dt>
<dd><p>\(T \times r\) matrix two-step factor estimates as in Doz, Giannone and Reichlin (2011) - obtained from running the data through the Kalman Filter and Smoother once, where the Filter is initialized with results from PCA.</p></dd>

<dt><code>P_2s</code></dt>
<dd><p>\(r \times r \times T\) covariance matrices of two-step factor estimates.</p></dd>

<dt><code>F_qml</code></dt>
<dd><p>\(T \times r\) matrix of quasi-maximum likelihood factor estimates - obtained by iteratively Kalman Filtering and Smoothing the factor estimates until EM convergence.</p></dd>

<dt><code>P_qml</code></dt>
<dd><p>\(r \times r \times T\) covariance matrices of QML factor estimates.</p></dd>

<dt><code>A</code></dt>
<dd><p>\(r \times rp\) factor transition matrix.</p></dd>

<dt><code>C</code></dt>
<dd><p>\(n \times r\) observation matrix.</p></dd>

<dt><code>Q</code></dt>
<dd><p>\(r \times r\) state (error) covariance matrix.</p></dd>

<dt><code>R</code></dt>
<dd><p>\(n \times n\) observation (error) covariance matrix.</p></dd>

<dt><code>e</code></dt>
<dd><p>\(T \times n\) estimates of observation errors \(\textbf{e}_t\). Only available if <code>idio.ar1 = TRUE</code>.</p></dd>

<dt><code>rho</code></dt>
<dd><p>\(n \times 1\) estimates of AR(1) coefficients (\(\rho\)) in observation errors: \(e_t = \rho e_{t-1} + v_t\). Only available if <code>idio.ar1 = TRUE</code>.</p></dd>

<dt><code>loglik</code></dt>
<dd><p>vector of log-likelihoods - one for each EM iteration. The final value corresponds to the log-likelihood of the reported model.</p></dd>

<dt><code>tol</code></dt>
<dd><p>The numeric convergence tolerance used.</p></dd>

<dt><code>converged</code></dt>
<dd><p>single logical valued indicating whether the EM algorithm converged (within <code>max.iter</code> iterations subject to <code>tol</code>).</p></dd>

<dt><code>anyNA</code></dt>
<dd><p>single logical valued indicating whether there were any (internal) missing values in the data (determined after removal of rows with too many missing values). If <code>FALSE</code>, <code>X_imp</code> is simply the original data in matrix form, and does not have the <code>"missing"</code> attribute attached.</p></dd>

<dt><code>rm.rows</code></dt>
<dd><p>vector of any cases (rows) that were removed beforehand (subject to <code>max.missing</code> and <code>na.rm.method</code>). If no cases were removed the slot is <code>NULL</code>.</p></dd>

<dt><code>em.method</code></dt>
<dd><p>The EM method used.</p></dd>

<dt><code>call</code></dt>
<dd><p>call object obtained from <code><a href="https://rdrr.io/r/base/match.call.html" class="external-link">match.call()</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function efficiently estimates a Dynamic Factor Model with the following classical assumptions:</p><ol><li><p>Linearity</p></li>
<li><p>Idiosynchratic measurement (observation) errors (<em>R</em> is diagonal)</p></li>
<li><p>No direct relationship between series and lagged factors (<em>ceteris paribus</em> contemporaneous factors)</p></li>
<li><p>No relationship between lagged error terms in the either measurement or transition equation (no serial correlation), unless explicitly modeled as AR(1) processes using <code>idio.ar1 = TRUE</code>.</p></li>
</ol><p>Factors are allowed to evolve in a \(VAR(p)\) process, and data is internally standardized (scaled and centered) before estimation (removing the need of intercept terms).
By assumptions 1-4, this translates into the following dynamic form:</p>
<p>$$\textbf{x}_t = \textbf{C}_0 \textbf{f}_t + \textbf{e}_t \ \sim\  N(\textbf{0}, \textbf{R})$$
$$\textbf{f}_t = \sum_{j=1}^p \textbf{A}_j \textbf{f}_{t-j} + \textbf{u}_t \ \sim\  N(\textbf{0}, \textbf{Q}_0)$$</p>
<p>where the first equation is called the measurement or observation equation and the second equation is called transition, state or process equation, and</p>
<table class="table table"><tr><td>\(n\)</td><td></td><td>number of series in \(\textbf{x}_t\) (\(r\) and \(p\) as the arguments to <code>DFM</code>).</td><td></td></tr><tr><td>\(\textbf{x}_t\)</td><td></td><td>\(n \times 1\) vector of observed series at time \(t\): \((x_{1t}, \dots, x_{nt})'\). Some observations can be missing.</td><td></td></tr><tr><td>\(\textbf{f}_t\)</td><td></td><td>\(r \times 1\) vector of factors at time \(t\): \((f_{1t}, \dots, f_{rt})'\).</td><td></td></tr><tr><td>\(\textbf{C}_0\)</td><td></td><td>\(n \times r\) measurement (observation) matrix.</td><td></td></tr><tr><td>\(\textbf{A}_j\)</td><td></td><td>\(r \times r\) state transition matrix at lag \(j\).</td><td></td></tr><tr><td>\(\textbf{Q}_0\)</td><td></td><td>\(r \times r\) state covariance matrix.</td><td></td></tr><tr><td>\(\textbf{R}\)</td><td></td><td>\(n \times n\) measurement (observation) covariance matrix. It is diagonal by assumption 2 that \(E[\textbf{x}_{it}|\textbf{x}_{-i,t},\textbf{x}_{i,t-1}, \dots, \textbf{f}_t, \textbf{f}_{t-1}, \dots] = \textbf{Cf}_t \forall i\).</td><td></td></tr></table><p>This model can be estimated using a classical form of the Kalman Filter and the Expectation Maximization (EM) algorithm, after transforming it to State-Space (stacked, VAR(1)) form:</p>
<p>$$\textbf{x}_t = \textbf{C} \textbf{F}_t + \textbf{e}_t \ \sim\  N(\textbf{0}, \textbf{R})$$
$$\textbf{F}_t = \textbf{A F}_{t-1} + \textbf{u}_t \ \sim\  N(\textbf{0}, \textbf{Q})$$</p>
<p>where</p><table class="table table"><tr><td>\(n\)</td><td></td><td>number of series in \(\textbf{x}_t\) (\(r\) and \(p\) as the arguments to <code>DFM</code>).</td><td></td></tr><tr><td>\(\textbf{x}_t\)</td><td></td><td>\(n \times 1\) vector of observed series at time \(t\): \((x_{1t}, \dots, x_{nt})'\). Some observations can be missing.</td><td></td></tr><tr><td>\(\textbf{F}_t\)</td><td></td><td>\(rp \times 1\) vector of stacked factors at time \(t\): \((f_{1t}, \dots, f_{rt}, f_{1,t-1}, \dots, f_{r,t-1}, \dots, f_{1,t-p}, \dots, f_{r,t-p})'\).</td><td></td></tr><tr><td>\(\textbf{C}\)</td><td></td><td>\(n \times rp\) observation matrix. Only the first \(n \times r\) terms are non-zero, by assumption 3 that \(E[\textbf{x}_t|\textbf{F}_t] = E[\textbf{x}_t|\textbf{f}_t]\) (no relationship of observed series with lagged factors given contemporaneous factors).</td><td></td></tr><tr><td>\(\textbf{A}\)</td><td></td><td>stacked \(rp \times rp\) state transition matrix consisting of 3 parts: the top \(r \times rp\) part provides the dynamic relationships captured by \((\textbf{A}_1, \dots, \textbf{A}_p)\) in the dynamic form, the terms <code>A[(r+1):rp, 1:(rp-r)]</code> constitute an \((rp-r) \times (rp-r)\) identity matrix mapping all lagged factors to their known values at times t. The remaining part <code>A[(rp-r+1):rp, (rp-r+1):rp]</code> is an \(r \times r\) matrix of zeros.</td><td></td></tr><tr><td>\(\textbf{Q}\)</td><td></td><td>\(rp \times rp\) state covariance matrix. The top \(r \times r\) part gives the contemporaneous relationships, the rest are zeros by assumption 4.</td><td></td></tr><tr><td>\(\textbf{R}\)</td><td></td><td>\(n \times n\) observation covariance matrix. It is diagonal by assumption 2 and identical to \(\textbf{R}\) as stated in the dynamic form.</td><td></td></tr></table></div>
    <div id="references">
    <h2>References</h2>
    <p>Doz, C., Giannone, D., &amp; Reichlin, L. (2011). A two-step estimator for large approximate dynamic factor models based on Kalman filtering. <em>Journal of Econometrics, 164</em>(1), 188-205.</p>
<p>Doz, C., Giannone, D., &amp; Reichlin, L. (2012). A quasi-maximum likelihood approach for large, approximate dynamic factor models. <em>Review of Economics and Statistics, 94</em>(4), 1014-1024.</p>
<p>Banbura, M., &amp; Modugno, M. (2014). Maximum likelihood estimation of factor models on datasets with arbitrary pattern of missing data. <em>Journal of Applied Econometrics, 29</em>(1), 133-160.</p>
<p>Stock, J. H., &amp; Watson, M. W. (2016). Dynamic Factor Models, Factor-Augmented Vector Autoregressions, and Structural Vector Autoregressions in Macroeconomics. <em>Handbook of Macroeconomics, 2</em>, 415–525. https://doi.org/10.1016/bs.hesmac.2016.04.002</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts" class="external-link">xts</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.pfaffikus.de" class="external-link">vars</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MASS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: strucchange</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sandwich</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: urca</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: lmtest</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># BM14 Replication Data. Constructing the database:</span></span>
<span class="r-in"><span class="va">BM14</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">BM14_M</span>, <span class="va">BM14_Q</span><span class="op">)</span></span>
<span class="r-in"><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">log_trans</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"M"</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">freq</span> <span class="op">==</span> <span class="st">"Q"</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Small Model ---------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># IC for number of factors</span></span>
<span class="r-in"><span class="va">IC_small</span> <span class="op">=</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">small</span><span class="op">]</span>, max.r <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># I take 2 factors. Now number of lags</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_small</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      6      5      2      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1          2         3          4         5          6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) -1.5028163 -1.7020957 -1.701093 -1.7021266 -1.782692 -1.7977899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  -1.4762557 -1.6578279 -1.639118 -1.6224446 -1.685303 -1.6826936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  -1.4361151 -1.5909270 -1.545457 -1.5020229 -1.538121 -1.5087511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n)  0.2225028  0.1823018  0.182486  0.1822997  0.168192  0.1656763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 7          8          9         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) -1.7892503 -1.7887748 -1.7793434 -1.7708400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  -1.6564469 -1.6382643 -1.6111258 -1.5849153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  -1.4557440 -1.4108011 -1.3569022 -1.3039313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n)  0.1671036  0.1671913  0.1687862  0.1702408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Estimating the model with 2 factors and 3 lags</span></span>
<span class="r-in"><span class="va">dfm_small</span> <span class="op">=</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">small</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 26 iterations.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Inspecting the model</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dynamic Factor Model: n = 14, T = 356, r = 2, p = 3, %NA = 38.3628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14[, BM14_Models$small], r = 2, p = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.0777   0.1544  2.0324  -8.9693  3.2519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356   0.0468  -0.0279  1.3933  -4.2683  5.8201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     L1.f1   L1.f2    L2.f1   L2.f2   L3.f1    L3.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1 1.2107 -0.1290 -0.06743  0.1059 -0.2065 0.008175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 0.3656  0.4819  0.10274 -0.2022 -0.6789 0.391439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1   4.1307   -0.4890*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  -0.4890*   1.9412 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        u1     u2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1 0.2845 0.2434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2 0.2434 0.4387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Matrix [C]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             f1      f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr             0.2450  0.1850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                0.0245  0.0323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                  0.1669  0.1692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl       0.0493 -0.0062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind         0.2450  0.4559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                 0.1196  0.4508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                    -0.3830  0.1478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val  0.0568  0.0847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                 0.1207  0.2317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                 0.0968  0.1707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                     0.3666  0.0236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                    0.3661 -0.2945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                0.2730 -0.1416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                  0.2194  0.1953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Error Covariance Matrix [diag(R) - Restricted]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.6374                 0.9906                 0.7938 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.9863                 0.3405                 0.3814 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.1861                 0.9708                 0.8215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.9028                 0.4079                 0.1488 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.5644                 0.7362 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation Residual Covariance Matrix [cov(resid(DFM))]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        ip_tot_cstr  new_cars    orders ret_turnover_defl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                0.6126   -0.0151    0.1996*          -0.0168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                  -0.0151    0.9943   -0.0077            0.1269*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                     0.1996*  -0.0077    0.7827            0.0342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl         -0.0168    0.1269*   0.0342            0.9885 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind           -0.0074   -0.0312   -0.0863*          -0.0018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                   -0.0591   -0.0482   -0.0184            0.0068 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                        0.0104   -0.0190    0.0524           -0.0095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val     0.0737    0.0962    0.0760           -0.0145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                   -0.0294    0.0543   -0.0896            0.0140 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                    0.0936    0.1054    0.0054            0.0392 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                       -0.0178   -0.0432   -0.0163            0.0624 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                      -0.0335   -0.0505    0.0229            0.0005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                  -0.0503   -0.0134   -0.0238           -0.0375 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                    -0.1565*   0.0034   -0.0046           -0.0659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        ecs_ec_sent_ind   pms_pmi       urx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                   -0.0074   -0.0591    0.0104 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                      -0.0312   -0.0482   -0.0190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                        -0.0863*  -0.0184    0.0524 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl             -0.0018    0.0068   -0.0095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind                0.2537   -0.0718*   0.0030 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                       -0.0718*   0.3167    0.0291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                            0.0030    0.0291    0.1653 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val        -0.0657*  -0.0426    0.0045 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                       -0.0290   -0.0365    0.0002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                       -0.0451    0.0409    0.0336 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                           -0.0813*  -0.0211   -0.0020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                           0.0453*   0.0421    0.0066 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                      -0.0567   -0.0113    0.0380 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                        -0.1000*  -0.0293    0.0423 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        extra_ea_trade_exp_val   euro325   raw_mat       gdp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr                           0.0737   -0.0294    0.0936   -0.0178 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                              0.0962    0.0543    0.1054   -0.0432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                                0.0760   -0.0896    0.0054   -0.0163 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl                    -0.0145    0.0140    0.0392    0.0624 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind                      -0.0657*  -0.0290   -0.0451   -0.0813*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                              -0.0426   -0.0365    0.0409   -0.0211 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                                   0.0045    0.0002    0.0336   -0.0020 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val                0.9693    0.0141   -0.0336    0.0744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                               0.0141    0.8026    0.0103   -0.0458 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                              -0.0336    0.0103    0.8897   -0.0561 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                                   0.0744   -0.0458   -0.0561    0.3798 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                                 -0.0301    0.0173    0.0022   -0.0311 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                             -0.0421   -0.0023   -0.2376*   0.1283*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                               -0.0775    0.0616   -0.0399    0.0510 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             empl  capacity    gdp_us</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ip_tot_cstr             -0.0335   -0.0503   -0.1565*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_cars                -0.0505   -0.0134    0.0034 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orders                   0.0229   -0.0238   -0.0046 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ret_turnover_defl        0.0005   -0.0375   -0.0659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ecs_ec_sent_ind          0.0453*  -0.0567   -0.1000*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pms_pmi                  0.0421   -0.0113   -0.0293 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> urx                      0.0066    0.0380    0.0423 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extra_ea_trade_exp_val  -0.0301   -0.0421   -0.0775 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> euro325                  0.0173   -0.0023    0.0616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raw_mat                  0.0022   -0.2376*  -0.0399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp                     -0.0311    0.1283*   0.0510 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> empl                     0.1155   -0.0515*  -0.0259 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> capacity                -0.0515*   0.5558    0.1338*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gdp_us                  -0.0259    0.1338*   0.7093 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual AR(1) Serial Correlation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.37927               -0.40846               -0.41429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -0.49173               -0.12364                0.09490 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0.01165               -0.52365                0.24452 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0.26723                     NA                     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     NA                     NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   10  -0.1723  -0.2515  0.3086  -0.5237  0.2672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness of Fit: R-Squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ip_tot_cstr               new_cars                 orders </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.3874                 0.0057                 0.2173 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ret_turnover_defl        ecs_ec_sent_ind                pms_pmi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.0115                 0.7463                 0.6833 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    urx extra_ea_trade_exp_val                euro325 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.8347                 0.0307                 0.1974 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                raw_mat                    gdp                   empl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.1103                 0.6202                 0.8845 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               capacity                 gdp_us </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.4442                 0.2907 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   14  0.3903  0.3391  0.3146  0.0057  0.8845</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span>  <span class="co"># Factors and data</span></span>
<span class="r-plt img"><img src="DFM-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span>, method <span class="op">=</span> <span class="st">"all"</span>, type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span> <span class="co"># Factor estimates</span></span>
<span class="r-plt img"><img src="DFM-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_small</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span>
<span class="r-plt img"><img src="DFM-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 10 periods ahead forecast</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_small</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Medium-Sized Model ---------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># IC for number of factors</span></span>
<span class="r-in"><span class="va">IC_medium</span> <span class="op">=</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">medium</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># I take 3 factors. Now number of lags</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_medium</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7      2      1      7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               1        2        3        4        5        6        7        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) 1.539267 1.492781 1.498671 1.509014 1.486111 1.479450 1.468524 1.490378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  1.592388 1.585744 1.631474 1.681659 1.698597 1.731776 1.760691 1.822386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  1.672669 1.726236 1.832177 1.942573 2.019721 2.113112 2.202238 2.324143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 4.661186 4.449528 4.475952 4.522752 4.420750 4.391987 4.345059 4.442132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               9       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n) 1.500199 1.534401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)  1.872048 1.946092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)  2.434016 2.568271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 4.487352 4.645257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Estimating the model with 3 factors and 3 lags</span></span>
<span class="r-in"><span class="va">dfm_medium</span> <span class="op">=</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span><span class="op">[</span>, <span class="va">BM14_Models</span><span class="op">$</span><span class="va">medium</span><span class="op">]</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 26 iterations.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Inspecting the model</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dynamic Factor Model: n = 48, T = 356, r = 3, p = 3, %NA = 32.6135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14[, BM14_Models$medium], r = 3, p = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD       Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.0403   0.4214  2.9848  -17.3578  5.4713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356  -0.0109  -0.2687  2.0526   -4.8352  8.2507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  356  -0.0274   -0.119  1.5727   -6.8234  4.0181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L1.f1    L1.f2   L1.f3    L2.f1     L2.f2   L2.f3    L3.f1   L3.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.74619  0.08633 0.28267  0.06055 -0.045219 -0.1494  0.07457 0.05102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.01289  0.40113 0.04716 -0.09857  0.104393  0.1231 -0.09578 0.24146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.14844 -0.06662 0.41315 -0.01687 -0.001667 -0.1762 -0.14472 0.15933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L3.f3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.06631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.02438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.15381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          f1       f2       f3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  8.9091   0.2889   0.2680 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  0.2889   4.2132   0.0017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.2680   0.0017   2.4733 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         u1      u2      u3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1  2.1176  1.1526 -0.3597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2  1.1526  1.9879 -0.4395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u3 -0.3597 -0.4395  2.0555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   39  -0.0879  -0.1043  0.2624  -0.5417  0.4481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N   Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   48  0.381  0.3489  0.2986  0.0073  0.9311</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span>  <span class="co"># Factors and data</span></span>
<span class="r-plt img"><img src="DFM-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span>, method <span class="op">=</span> <span class="st">"all"</span>, type <span class="op">=</span> <span class="st">"individual"</span><span class="op">)</span> <span class="co"># Factor estimates</span></span>
<span class="r-plt img"><img src="DFM-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_medium</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span>
<span class="r-plt img"><img src="DFM-11.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 10 periods ahead forecast</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_medium</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-12.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Large Model ---------------------------------</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co"># IC for number of factors</span></span>
<span class="r-in"><span class="va">IC_large</span> <span class="op">=</span> <span class="fu"><a href="ICr.html">ICr</a></span><span class="op">(</span><span class="va">BM14</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing values detected: imputing data with tsnarmimp() with default settings</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-14.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># I take 6 factors. Now number of lags</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/VARselect.html" class="external-link">VARselect</a></span><span class="op">(</span><span class="va">IC_large</span><span class="op">$</span><span class="va">F_pca</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $selection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)  HQ(n)  SC(n) FPE(n) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      6      1      1      6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 1          2          3          4          5          6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)   6.020768   5.926947   5.883307   5.889824   5.897327   5.845883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)    6.206692   6.272235   6.387960   6.553841   6.720708   6.828628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)    6.487677   6.794063   7.150631   7.557355   7.965066   8.313830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 411.908362 375.087393 359.232802 361.888929 365.116976 347.515300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 7          8          9         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC(n)   5.908082   5.963699   5.982969   6.111831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HQ(n)    7.050191   7.265172   7.443806   7.732032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SC(n)    8.776235   9.232061   9.651538  10.180607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FPE(n) 370.862536 393.546431 403.139879 461.355079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Estimating the model with 6 factors and 3 lags</span></span>
<span class="r-in"><span class="va">dfm_large</span> <span class="op">=</span> <span class="fu">DFM</span><span class="op">(</span><span class="va">BM14</span>, <span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged after 42 iterations.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Inspecting the model</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/vars/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dynamic Factor Model: n = 101, T = 356, r = 6, p = 3, %NA = 29.7363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  DFM(X = BM14, r = 6, p = 3)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Statistics of Factors [F]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N     Mean   Median      SD       Min      Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  356  -0.0128   0.6589  4.8593  -22.6273  12.1396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  356  -0.1426   0.1953  3.2924  -13.4553  17.0049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  356  -0.0121   0.0539  2.6158  -10.0501    7.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  356   0.0532    0.227  3.0551  -17.2138   10.345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  356  -0.0526  -0.0474  2.6591  -10.8706  11.5097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  356  -0.0074  -0.0276  2.3392   -8.0883  15.4214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Matrix [A]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      L1.f1    L1.f2     L1.f3    L1.f4    L1.f5    L1.f6    L2.f1    L2.f2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.4892 -0.27413  0.555373 -0.49350  0.33904 -0.10227 -0.10721  0.04923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2 -0.1409  0.42355 -0.119072 -0.09760  0.11595  0.14366  0.19016 -0.06640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3  0.2769  0.06985  0.394982  0.10002 -0.12723 -0.11881 -0.20734  0.04944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.2432 -0.03345  0.085401 -0.18619  0.52093 -0.04263  0.01735 -0.17177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.2858  0.01547 -0.008841  0.40969  0.07289  0.01797 -0.01169  0.16386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6 -0.2178  0.12874 -0.113025 -0.03033 -0.09462  0.40510  0.10945 -0.09195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L2.f3    L2.f4    L2.f5    L2.f6     L3.f1    L3.f2     L3.f3     L3.f4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1 -0.23156 -0.14988 -0.06505  0.50861  0.367040 -0.11658  0.070419  0.008798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  0.07793 -0.07484  0.21098 -0.19913  0.091421  0.22904  0.008526 -0.142987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.32524  0.23108 -0.07323  0.10170 -0.004843 -0.10569  0.186417  0.121418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4  0.08269 -0.19694  0.05137  0.11849  0.054295 -0.13206 -0.029156  0.100593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5 -0.12568 -0.01248 -0.15211 -0.01158 -0.145431  0.01864  0.038644  0.038082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  0.11387 -0.08252  0.14040 -0.19996  0.015064  0.05480  0.060205 -0.111405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       L3.f5    L3.f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  0.13116 -0.02589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  0.02080  0.17876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3 -0.12427 -0.03180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4 -0.05662  0.06638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  0.02519 -0.18284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  0.05736  0.10027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Covariance Matrix [cov(F)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           f1        f2        f3        f4        f5        f6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f1  23.6126   -0.2329    0.1166    4.0970*  -2.4727*  -2.8984*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f2  -0.2329   10.8399   -1.8458*   0.6389   -1.1282*   2.1751*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f3   0.1166   -1.8458*   6.8426   -1.6781*   1.6056*  -1.2712*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f4   4.0970*   0.6389   -1.6781*   9.3339   -4.2441*  -0.0480 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f5  -2.4727*  -1.1282*   1.6056*  -4.2441*   7.0708   -0.6045 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f6  -2.8984*   2.1751*  -1.2712*  -0.0480   -0.6045    5.4720 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor Transition Error Covariance Matrix [Q]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         u1      u2      u3      u4      u5      u6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u1  9.4291 -0.3199 -1.3015  2.2611 -2.0748  0.0669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u2 -0.3199  5.3107  0.0049  0.8209 -0.5604 -0.0135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u3 -1.3015  0.0049  4.3942 -0.5711  0.4848  0.0342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u4  2.2611  0.8209 -0.5711  4.8600 -1.6002  0.1788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u5 -2.0748 -0.5604  0.4848 -1.6002  4.4129 -0.0902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> u6  0.0669 -0.0135  0.0342  0.1788 -0.0902  3.2699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Residual AR(1) Serial Correlations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    N     Mean   Median      SD      Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   92  -0.0706  -0.0965  0.2712  -0.5567  0.6628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Individual R-Squared's</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N    Mean  Median      SD     Min     Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   101  0.4677  0.4352  0.2929  0.0096  0.9984</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span>  <span class="co"># Factors and data</span></span>
<span class="r-plt img"><img src="DFM-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># plot(dfm_large, method = "all", type = "individual") # Factor estimates</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dfm_large</span>, type <span class="op">=</span> <span class="st">"residual"</span><span class="op">)</span> <span class="co"># Residuals from factor predictions</span></span>
<span class="r-plt img"><img src="DFM-16.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 10 periods ahead forecast</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vars/man/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dfm_large</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">370</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="DFM-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Krantz, Rytis Bagdziunas.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

